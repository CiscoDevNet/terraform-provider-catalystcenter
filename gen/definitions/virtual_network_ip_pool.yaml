---
name: Virtual Network IP Pool
rest_endpoint: /dna/intent/api/v1/business/sda/virtualnetwork/ippool
no_update: true
no_import: true
no_data_source: true
skip_minimum_test: true
res_description: Manages IP Pool in SDA Virtual Network
# added time sleep for GET, POST, DELETE operations to fix API issues, and updated Create, Read and Delete functions manually
doc_category: SDA
attributes:
  - model_name: virtualNetworkName
    requires_replace: true
    type: String
    mandatory: true
    description: Virtual Network Name, that is associated to Fabric Site
    example: SDA_VN1
    test_value: catalystcenter_virtual_network_to_fabric_site.test.virtual_network_name
  - model_name: siteNameHierarchy
    requires_replace: true
    mandatory: true
    type: String
    description: Path of sda Fabric Site
    example: "Global/Area1"
    test_value: catalystcenter_virtual_network_to_fabric_site.test.site_name_hierarchy
  - model_name: isLayer2Only
    requires_replace: true
    tf_name: layer2_only
    type: Bool
    default_value: false
    description: Layer2 Only enablement flag and default value is False 
    example: false
  - model_name: ipPoolName
    requires_replace: true
    type: String
    description: Ip Pool Name, that is reserved to Fabric Site (Required for L3 and INFRA_VN)
    example: MyPool1
    test_value: catalystcenter_ip_pool_reservation.test.name
  - model_name: vlanId
    requires_replace: true
    type: String
    description: vlan Id(applicable for L3 , L2 and INFRA_VN)
    example: "401"
  - model_name: vlanName
    requires_replace: true
    type: String
    description: Vlan name represent the segment name, if empty, vlanName would be auto generated by API
    mandatory: true
    example: VLAN401
  - model_name: autoGenerateVlanName
    requires_replace: true
    type: Bool
    description: It will auto generate vlanName, if vlanName is empty(applicable for L3 and INFRA_VN)
    exclude_test: true
  - model_name: trafficType
    requires_replace: true
    type: String
    enum_values: [DATA, VOICE]
    mandatory: true
    description: Traffic type(applicable for L3 and L2)
    example: DATA
  - model_name: scalableGroupName
    requires_replace: true
    type: String
    description: Scalable Group Name(applicable for L3)
    exclude_test: true
  - model_name: isL2FloodingEnabled
    requires_replace: true
    response_data_path: isSelectiveFloodingEnabled
    tf_name: l2_flooding_enabled
    type: Bool
    description: Layer2 flooding enablement flag(applicable for L3 , L2 and always true for L2 and default value is False)
    example: false
  - model_name: isThisCriticalPool
    requires_replace: true
    write_only: true
    tf_name: critical_pool
    type: Bool
    description: Critical pool enablement flag(applicable for L3 and default value is False )
    example: false
  - model_name: isWirelessPool
    requires_replace: true
    tf_name: wireless_pool
    type: Bool
    description: Wireless Pool enablement flag(applicable for L3 and L2 and default value is False)
    example: false
  - model_name: isIpDirectedBroadcast
    requires_replace: true
    tf_name: ip_directed_broadcast
    type: Bool
    description: Ip Directed Broadcast enablement flag(applicable for L3 and default value is False)
    example: false
  - model_name: isCommonPool
    requires_replace: true
    tf_name: common_pool
    type: Bool
    description: Common Pool enablement flag(applicable for L3 and L2 and default value is False)
    example: false
  - model_name: isBridgeModeVm
    requires_replace: true
    tf_name: bridge_mode_vm
    type: Bool
    description: Bridge Mode Vm enablement flag (applicable for L3 and L2 and default value is False)
    example: false
  - model_name: poolType
    requires_replace: true
    type: String
    enum_values: [AP, Extended]
    description: Pool Type (applicable for INFRA_VN)
    exclude_test: true
test_prerequisites: |
  resource "catalystcenter_area" "test" {
    name        = "Area1"
    parent_name = "Global"
    depends_on  = [catalystcenter_ip_pool.test]
  }
  resource "catalystcenter_ip_pool" "test" {
    name             = "MyPool1"
    ip_subnet        = "172.32.0.0/16"
  }
  resource "catalystcenter_ip_pool_reservation" "test" {
    site_id            = catalystcenter_area.test.id
    name               = "MyRes1"
    type               = "Generic"
    ipv4_global_pool   = catalystcenter_ip_pool.test.ip_subnet
    ipv4_prefix        = true
    ipv4_prefix_length = 24
    ipv4_subnet        = "172.32.1.0"
    depends_on = [catalystcenter_ip_pool.test]
  }
  resource "catalystcenter_fabric_site" "test" {
    site_name_hierarchy = "Global/Area1"
    fabric_type         = "FABRIC_SITE"
    depends_on = [catalystcenter_area.test]
  }
  resource "catalystcenter_fabric_virtual_network" "test" {
    virtual_network_name = "SDA_VN1"
    is_guest             = false
    sg_names             = ["Employees"]
  }
  resource "catalystcenter_virtual_network_to_fabric_site" "test" {
    virtual_network_name = "SDA_VN1"
    site_name_hierarchy  = "Global/Area1"
    depends_on = [catalystcenter_fabric_virtual_network.test, catalystcenter_fabric_site.test]
  }